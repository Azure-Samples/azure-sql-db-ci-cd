


create view [data].[RK_Transaction_MtFareProductSale] as
(
    select
        [FileId],
        [TransactionID],
        [MsgReportDate],
        [MsgSequenceNumber],
        [DeviceID],
        -- ComMainHeader
        [TransactionType],
        [TransactionBusinessDate],
        [TransactionStatus],
        [TransactionMediaLastDeviceID],
        [ServiceProviderID],
        [ContractorID],
        [FareAuthorityID],
        [StationID],
        [StopPointID],
        [ModalType],
        [ServiceJourneyType],
        [StaffID],
        [StaffType],
        [ShiftNumber],
        [MediaSerialNumberID],
        [MediaCountryCode],
        [MediaIssuerID],
        [MediaRetailerID],
        [MediaType],
        [MediaValidityDate],
        [MediaVersion],
        [MediaSecurityLevel],
        [MediaTest],
        [CardEngravedID],
        [ApplicationStatus],
        [ApplicationTransactionSequenceNumber],
        [ActionListStatus],
        [ActionListID],
        [ActionListFailureCode],
        [CSCCurrencyUnit],
        [SystemCurrencyUnit],
        [EODVersionID],
        [EODVersionComponent1],
        [EODVersionComponent2],
        [EODVersionComponent3],
        [EODVersionComponent4],
        [EODVersionComponent5],
        [EODVersionComponent6],
        [EODVersionComponent7],
        [EODVersionComponent8],
        [EODVersionComponent9],
        [TrackingOperationType],
        [TrackingOperationNumber],
        -- ComVehicleGeographicalInfo
        [VehicleID],
        [RouteID],
        [TripTimeDeparture],
        [LinePublicNumber],
        [TripType],
        -- ComPassengerGroup
        [PassengerGroupType1],
        [PassengerGroupTotal1],
        [PassengerGroupSupplement1],
        [PassengerGroupType2],
        [PassengerGroupTotal2],
        [PassengerGroupSupplement2],
        [PassengerGroupType3],
        [PassengerGroupTotal3],
        [PassengerGroupSupplement3],
        -- ComPaymentInfo
        [TerminalID],
        [PaymentID],
        [CreditCardType],
        [PaymentMeansType],
        [PaymentAgreementPTOId],
        [PaymentAmount],
        [ChangeAmount],
        [PaymentSequenceNumber],
        [NbTransactionsPaid],
        -- ComProductInstanceFixedPart
        [ProductOwnerID],
        [ProductCode],
        [ProductFareVersion],
        [ProductSequenceNumber],
        [ProductSaleDeviceID],
        -- ComProductInstanceFixedPart
        [SourceID],
        [ViaID],
        [DestinationID],
        [AdditionalZone1],
        [AdditionalZone2],
        [AdditionalZone3],
        [AdditionalZone4],
        [AdditionalZone5],
        [AdditionalZone6],
        [AdditionalZone7],
        [AdditionalZone8],
        [AdditionalZone9],
        [AdditionalZone10],
        [AdditionalZone11],
        [AdditionalZone12],
        [AdditionalZone13],
        [AdditionalZone14],
        [AdditionalZone15],
        [AdditionalZone16],
        [AdditionalZone17],
        [AdditionalZone18],
        [AdditionalZone19],
        [AdditionalZone20],
        [AdditionalZone21],
        [AdditionalZone22],
        [AdditionalZone23],
        [AdditionalZone24],
        [AdditionalZone25],
        [AdditionalZone26],
        [AdditionalZone27],
        [CentreZoneRadiusNumber],
        [ProductEffectiveDate],
        [ProductExpiryDate],
        [ProductNumberOfPeriod],
        [ProductPeriodType],
        [ProductPassengerClass],
        [ProductAutoRenew],
        [ProductAutoRenewLastDate],
        -- ComProductInstanceVariablePart
        [ProductStatus],
        [ProductValidityStartDate],
        [ProductValidityEndDate],
        [FareSetReferenceNumber],
        [DueFeeValue],
        [FeeValue],
        [ProductAmount],
        [ProductFamily],
        [SalePointGroup],
        [TransactionValue],
        -- Additional fields
        [JourneyRef],
        [JourneyPointRef]
    from
        [data].[RK_Transaction] (nolock)
    where
        [TransactionType] = 6
)

GO

