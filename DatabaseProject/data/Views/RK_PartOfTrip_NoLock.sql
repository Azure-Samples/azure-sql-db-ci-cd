



/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [data].[RK_PartOfTrip_NoLock]
AS
(
SELECT	
    [TripRef]
   ,[CardTransactionSequenceNumber]
   ,[TransactionID]
   ,[TransactionType]
   ,[ServiceProviderID]
   ,[ServiceProviderName]
   ,[DeviceID]
   ,[ContractorID]
   ,[ContractorName]
   ,[ModalType]
   ,[MsgReportDate]
   ,[MediaTypeName]
   ,[BusinessDayDate]
   ,[TransactionValue]
   ,[ValidationModel]
   ,[ValidationModelCode]
   ,[FareSetReferenceNumber]
   ,[FareSetReferenceName]
   ,[SiteID]
   ,[SiteName]
   ,[StopPointID]
   ,[StopPointName]
   ,[TripID]
   ,[TripDate]
   ,[TripType]
   ,[TripStartTime]
   ,[RouteName]
   ,[PartialTripFromStopPointID]
   ,[PartialTripFromStopPointName]
   ,[PartialTripToStopPointID]
   ,[PartialTripToStopPointName]
   ,[TripPrice]
   ,[TripPrice_Share_Arriva]
   ,[TripPrice_Share_First]
   ,[TripPrice_Share_Sydtrafik]
   ,[TripPrice_Share_DSB]
   ,[TripPrice_Share_Movia_S]
   ,[TripPrice_Share_Movia_V]
   ,[TripPrice_Share_Movia_H]
   ,[TripPrice_Share_S_tog]
   ,[TripPrice_Share_NT]
   ,[TripPrice_Share_Metro]
   ,[TripPrice_Share_Midttrafik]
   ,[TripPrice_Share_Fynbus]
   ,[TripPrice_Share_Delocalized]
   ,[ProductCode]
   ,[ProductName]
   ,[VehicleID]
   ,[JourneyRef]
   ,[FromJourneyPointRef]
   ,[FromJourneyPointMatchType]
   ,[FromJourneyPointMatchDistance]
   ,[ToJourneyPointRef]
   ,[ToJourneyPointMatchType]
   ,[ToJourneyPointMatchDistance]
,[StartSiteID]                    
,[StartSiteName]                  
,[EndSiteID]                      
,[EndSiteName] 
,[Model]                           = NULL
,[Weight]                         
,[Zones_Share]                    
,[ZonePrice]                      
,[ZonePriceBasis]                 
,[TripPrice_Share_NotDivided]    
FROM
    [data].[RK_PartOfTrip_2024] (NOLOCK)
UNION ALL
SELECT	
    [TripRef]
   ,[CardTransactionSequenceNumber]
   ,[TransactionID]
   ,[TransactionType]
   ,[ServiceProviderID]
   ,[ServiceProviderName]
   ,[DeviceID]
   ,[ContractorID]
   ,[ContractorName]
   ,[ModalType]
   ,[MsgReportDate]
   ,[MediaTypeName]
   ,[BusinessDayDate]
   ,[TransactionValue]
   ,[ValidationModel]
   ,[ValidationModelCode]
   ,[FareSetReferenceNumber]
   ,[FareSetReferenceName]
   ,[SiteID]
   ,[SiteName]
   ,[StopPointID]
   ,[StopPointName]
   ,[TripID]
   ,[TripDate]
   ,[TripType]
   ,[TripStartTime]
   ,[RouteName]
   ,[PartialTripFromStopPointID]
   ,[PartialTripFromStopPointName]
   ,[PartialTripToStopPointID]
   ,[PartialTripToStopPointName]
   ,[TripPrice]
   ,[TripPrice_Share_Arriva]
   ,[TripPrice_Share_First]
   ,[TripPrice_Share_Sydtrafik]
   ,[TripPrice_Share_DSB]
   ,[TripPrice_Share_Movia_S]
   ,[TripPrice_Share_Movia_V]
   ,[TripPrice_Share_Movia_H]
   ,[TripPrice_Share_S_tog]
   ,[TripPrice_Share_NT]
   ,[TripPrice_Share_Metro]
   ,[TripPrice_Share_Midttrafik]
   ,[TripPrice_Share_Fynbus]
   ,[TripPrice_Share_Delocalized]
   ,[ProductCode]
   ,[ProductName]
   ,[VehicleID]
   ,[JourneyRef]
   ,[FromJourneyPointRef]
   ,[FromJourneyPointMatchType]
   ,[FromJourneyPointMatchDistance]
   ,[ToJourneyPointRef]
   ,[ToJourneyPointMatchType]
   ,[ToJourneyPointMatchDistance]
,[StartSiteID]                    
,[StartSiteName]                  
,[EndSiteID]                      
,[EndSiteName] 
,[Model]                           = NULL
,[Weight]                         
,[Zones_Share]                    
,[ZonePrice]                      
,[ZonePriceBasis]                 
,[TripPrice_Share_NotDivided]    
FROM
    [data].[RK_PartOfTrip_2023] (NOLOCK)
UNION ALL
SELECT	
    [TripRef]
   ,[CardTransactionSequenceNumber]
   ,[TransactionID]
   ,[TransactionType]
   ,[ServiceProviderID]
   ,[ServiceProviderName]
   ,[DeviceID]
   ,[ContractorID]
   ,[ContractorName]
   ,[ModalType]
   ,[MsgReportDate]
   ,[MediaTypeName]
   ,[BusinessDayDate]
   ,[TransactionValue]
   ,[ValidationModel]
   ,[ValidationModelCode]
   ,[FareSetReferenceNumber]
   ,[FareSetReferenceName]
   ,[SiteID]
   ,[SiteName]
   ,[StopPointID]
   ,[StopPointName]
   ,[TripID]
   ,[TripDate]
   ,[TripType]
   ,[TripStartTime]
   ,[RouteName]
   ,[PartialTripFromStopPointID]
   ,[PartialTripFromStopPointName]
   ,[PartialTripToStopPointID]
   ,[PartialTripToStopPointName]
   ,[TripPrice]
   ,[TripPrice_Share_Arriva]
   ,[TripPrice_Share_First]
   ,[TripPrice_Share_Sydtrafik]
   ,[TripPrice_Share_DSB]
   ,[TripPrice_Share_Movia_S]
   ,[TripPrice_Share_Movia_V]
   ,[TripPrice_Share_Movia_H]
   ,[TripPrice_Share_S_tog]
   ,[TripPrice_Share_NT]
   ,[TripPrice_Share_Metro]
   ,[TripPrice_Share_Midttrafik]
   ,[TripPrice_Share_Fynbus]
   ,[TripPrice_Share_Delocalized]
   ,[ProductCode]
   ,[ProductName]
   ,[VehicleID]
   ,[JourneyRef]
   ,[FromJourneyPointRef]
   ,[FromJourneyPointMatchType]
   ,[FromJourneyPointMatchDistance]
   ,[ToJourneyPointRef]
   ,[ToJourneyPointMatchType]
   ,[ToJourneyPointMatchDistance]
,[StartSiteID]                    
,[StartSiteName]                  
,[EndSiteID]                      
,[EndSiteName] 
,[Model]                           = NULL
,[Weight]                         
,[Zones_Share]                    
,[ZonePrice]                      
,[ZonePriceBasis]                 
,[TripPrice_Share_NotDivided]    
FROM
    [data].[RK_PartOfTrip_2022] (NOLOCK)
UNION ALL
SELECT
    [TripRef]
   ,[CardTransactionSequenceNumber]
   ,[TransactionID]
   ,[TransactionType]
   ,[ServiceProviderID]
   ,[ServiceProviderName]
   ,[DeviceID]
   ,[ContractorID]
   ,[ContractorName]
   ,[ModalType]
   ,[MsgReportDate]
   ,[MediaTypeName]
   ,[BusinessDayDate]
   ,[TransactionValue]
   ,[ValidationModel]
   ,[ValidationModelCode]
   ,[FareSetReferenceNumber]
   ,[FareSetReferenceName]
   ,[SiteID]
   ,[SiteName]
   ,[StopPointID]
   ,[StopPointName]
   ,[TripID]
   ,[TripDate]
   ,[TripType]
   ,[TripStartTime]
   ,[RouteName]
   ,[PartialTripFromStopPointID]
   ,[PartialTripFromStopPointName]
   ,[PartialTripToStopPointID]
   ,[PartialTripToStopPointName]
   ,[TripPrice]
   ,[TripPrice_Share_Arriva]
   ,[TripPrice_Share_First]
   ,[TripPrice_Share_Sydtrafik]
   ,[TripPrice_Share_DSB]
   ,[TripPrice_Share_Movia_S]
   ,[TripPrice_Share_Movia_V]
   ,[TripPrice_Share_Movia_H]
   ,[TripPrice_Share_S_tog]
   ,[TripPrice_Share_NT]
   ,[TripPrice_Share_Metro]
   ,[TripPrice_Share_Midttrafik]
   ,[TripPrice_Share_Fynbus]
   ,[TripPrice_Share_Delocalized]
   ,[ProductCode]
   ,[ProductName]
   ,[VehicleID]
   ,[JourneyRef]
   ,[FromJourneyPointRef]
   ,[FromJourneyPointMatchType]
   ,[FromJourneyPointMatchDistance]
   ,[ToJourneyPointRef]
   ,[ToJourneyPointMatchType]
   ,[ToJourneyPointMatchDistance]
,[StartSiteID]                    
,[StartSiteName]                  
,[EndSiteID]                      
,[EndSiteName]  
,[Model]                            = NULL
,[Weight]                         
,[Zones_Share]                    
,[ZonePrice]                      
,[ZonePriceBasis]                 
,[TripPrice_Share_NotDivided]      
FROM
    [data].[RK_PartOfTrip_2021] (NOLOCK)
UNION ALL
SELECT
    [TripRef]
   ,[CardTransactionSequenceNumber]
   ,[TransactionID]
   ,[TransactionType]
   ,[ServiceProviderID]
   ,[ServiceProviderName]
   ,[DeviceID]
   ,[ContractorID]
   ,[ContractorName]
   ,[ModalType]
   ,[MsgReportDate]
   ,[MediaTypeName]
   ,[BusinessDayDate]
   ,[TransactionValue]
   ,[ValidationModel]
   ,[ValidationModelCode] = NULL
   ,[FareSetReferenceNumber]
   ,[FareSetReferenceName]
   ,[SiteID]
   ,[SiteName]
   ,[StopPointID]
   ,[StopPointName]
   ,[TripID]
   ,[TripDate]
   ,[TripType]
   ,[TripStartTime]
   ,[RouteName]
   ,[PartialTripFromStopPointID]
   ,[PartialTripFromStopPointName]
   ,[PartialTripToStopPointID]
   ,[PartialTripToStopPointName]
   ,[TripPrice]
   ,[TripPrice_Share_Arriva]
   ,[TripPrice_Share_First]
   ,[TripPrice_Share_Sydtrafik]
   ,[TripPrice_Share_DSB]
   ,[TripPrice_Share_Movia_S]
   ,[TripPrice_Share_Movia_V]
   ,[TripPrice_Share_Movia_H]
   ,[TripPrice_Share_S_tog]
   ,[TripPrice_Share_NT]
   ,[TripPrice_Share_Metro]
   ,[TripPrice_Share_Midttrafik] = NULL
   ,[TripPrice_Share_Fynbus]
   ,[TripPrice_Share_Delocalized]
   ,[ProductCode] = NULL
   ,[ProductName] = NULL
   ,[VehicleID]
   ,[JourneyRef]
   ,[FromJourneyPointRef]
   ,[FromJourneyPointMatchType]
   ,[FromJourneyPointMatchDistance]
   ,[ToJourneyPointRef]
   ,[ToJourneyPointMatchType]
   ,[ToJourneyPointMatchDistance]
   ,[StartSiteID]                    
,[StartSiteName]                  
,[EndSiteID]                      
,[EndSiteName] 
,[Model]                           
,[Weight]                         
,[Zones_Share]                    
,[ZonePrice]                      
,[ZonePriceBasis]                 
,[TripPrice_Share_NotDivided]   =NULL    
FROM
    [data].[RK_PartOfTrip_2020] (NOLOCK)
UNION ALL
SELECT
    [TripRef]
   ,[CardTransactionSequenceNumber]
   ,[TransactionID]
   ,[TransactionType]
   ,[ServiceProviderID]
   ,[ServiceProviderName]
   ,[DeviceID]
   ,[ContractorID]
   ,[ContractorName]
   ,[ModalType]
   ,[MsgReportDate]
   ,[MediaTypeName]
   ,[BusinessDayDate]
   ,[TransactionValue]
   ,[ValidationModel]
   ,[ValidationModelCode] = NULL
   ,[FareSetReferenceNumber]
   ,[FareSetReferenceName]
   ,[SiteID]
   ,[SiteName]
   ,[StopPointID]
   ,[StopPointName]
   ,[TripID]
   ,[TripDate]
   ,[TripType]
   ,[TripStartTime]
   ,[RouteName]
   ,[PartialTripFromStopPointID]
   ,[PartialTripFromStopPointName]
   ,[PartialTripToStopPointID]
   ,[PartialTripToStopPointName]
   ,[TripPrice]
   ,[TripPrice_Share_Arriva]
   ,[TripPrice_Share_First]
   ,[TripPrice_Share_Sydtrafik]
   ,[TripPrice_Share_DSB]
   ,[TripPrice_Share_Movia_S]
   ,[TripPrice_Share_Movia_V]
   ,[TripPrice_Share_Movia_H]
   ,[TripPrice_Share_S_tog]
   ,[TripPrice_Share_NT]
   ,[TripPrice_Share_Metro]
   ,[TripPrice_Share_Midttrafik] = NULL
   ,[TripPrice_Share_Fynbus]
   ,[TripPrice_Share_Delocalized]
   ,[ProductCode] = NULL
   ,[ProductName] = NULL
   ,[VehicleID]
   ,[JourneyRef]
   ,[FromJourneyPointRef]
   ,[FromJourneyPointMatchType]
   ,[FromJourneyPointMatchDistance]
   ,[ToJourneyPointRef]
   ,[ToJourneyPointMatchType]
   ,[ToJourneyPointMatchDistance]
,[StartSiteID]                    
,[StartSiteName]                  
,[EndSiteID]                      
,[EndSiteName]                    
,[Model]                          
,[Weight]                         
,[Zones_Share]                    
,[ZonePrice]                      
,[ZonePriceBasis]                              
,[TripPrice_Share_NotDivided] = NULL      
FROM
    [data].[RK_PartOfTrip_2019] (NOLOCK)

);

GO

