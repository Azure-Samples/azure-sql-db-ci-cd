



CREATE VIEW [dim].[LineDesignationGroup]
AS

--get unique list of LineDesignations
	WITH tblLine AS
		(
			SELECT DISTINCT LineDesignation
			FROM [dim].[Line]
		)

--group LineDesignations into A/C Lines, StrategicNet, Other
--(a LineDesignation can be member of more than one of the categories)
		SELECT 
				LineDesignation,
				CASE
							WHEN
								LineDesignation IN (
									'1A',
									'2A',
									'4A',
									'5C',
									'6A',
									'7A',
									'9A'
									) THEN 1
								ELSE 0
						END ACLines
					,CASE
							WHEN
								 LineDesignation IN (
									'230R','245R','260R','310R','320R','360R','365R','375R','380R','390R','430R','440R','470R','480R','620R','630R','660R','661R','720R'
									,'150S','200S','250S','300S','350S','400','400S','500S','600S'
									,'1A','2A','4A','6A','7A','9A','101A','102A','201A','202A','401A','501A','801A'
									,'5C'
									,'123','184','203','215','220','234','240','301','302','354','370','402','405','420','421','425','460','520','540','551','552','560','570','601','602','603','670','680','701','702','730','736','740','901','902','903','907'
									) THEN 1
								ELSE 0
						END StrategicNetLines
					,CASE
							WHEN
								 LineDesignation IN (
										'10', '11', '12', '13', '14',
                                        '15E', '18', '21', '22',
                                        '23', '26', '27', '30E',
                                        '31', '32', '33', '34', '35',
                                        '36', '37', '40E', '55E',
                                        '65E', '68', '71', '72',
                                        '74', '77', '78', '93N',
                                        '94N', '97N', '103', '106',
                                        '108', '109', '114', '115',
                                        '116', '117', '118', '119',
                                        '120', '121', '127', '128',
                                        '132', '133', '134', '137', '139',
                                        '141', '142', '143', '144',
                                        '145', '147', '149', '151',
                                        '152', '155', '156', '157',
                                        '158', '160', '161', '163',
                                        '164', '165', '166', '167',
                                        '168', '171', '172', '176',
                                        '179', '180', '181', '182',
                                        '183', '185', '190', '191',
                                        '192', '193', '194', '195',
                                        '196', '197', '198', '199',
                                        '204', '205', '206', '207',
                                        '208', '209', '212', '216',
                                        '217', '218', '219', '221',
                                        '223', '224', '225', '226',
                                        '227', '228', '231', '233', '236',
                                        '241', '242', '243', '244',
										'246', '251', '252', '253',
                                        '254', '261', '263', '264',
                                        '265', '266', '267', '271',
                                        '272', '273', '274', '275',
                                        '281', '282', '283', '287',
                                        '303', '305', '305E', '307', '311',
                                        '312', '313', '314', '315', '316',
                                        '317', '318', '319', '321',
                                        '322', '323', '325', '326',
                                        '327', '328', '332', '333',
                                        '334', '335', '336', '337',
                                        '338', '340', '342', '345',
                                        '347', '353', '358', '361',
                                        '362', '363', '370R', '374', '381', '383',
                                        '385', '388', '404', '405E', '406',
                                        '408', '411', '415', '425', '431',
                                        '432', '437', '460R', '462', '465',
                                        '466', '467', '468', '469',
                                        '481', '482', '483', '484',
                                        '485', '486', '487', '488',
                                        '490', '494', '495', '499',
                                        '502', '504', '505', '506',
                                        '507', '511', '512', '513',
                                        '530', '541', '542', '543',
                                        '544', '545', '553', '561',
                                        '562', '563', '565', '566',
                                        '568', '571', '572', '573',
                                        '576', '577', '581', '582',
                                        '583', '584', '585', '586',
                                        '587', '588', '589', '591',
                                        '592', '593', '595', '596',
                                        '597', '598', '601A', '604', '605',
                                        '607', '608', '611', '615',
                                        '640', '664', '667', '669',
										'684', '685',
                                        '691', '692', '693', '694', '697',
									    '703', '711', '714', '721', '722',
                                        '715', '716', '717', '718',
                                        '719', '723', '724', '725',
                                        '731', '737', '741', '742', '743',
                                        '750', '751', '752', '755',
                                        '760', '761', '762', '763',
                                        '771', '772', '773', '774',
                                        '778', '780', '791', '792',
                                        '802', '803', 
										'834', '835', '847', '848', '851',
										'884', '885', '897',
										'904', '905',  '909',
										'90N', '91N', '98N', '99N')
									 THEN 1
								ELSE 0
						END OtherLines
		FROM tblLine

GO

